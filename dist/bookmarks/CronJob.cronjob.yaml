apiVersion: batch/v1
kind: CronJob
metadata:
  name: cronjob
spec:
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 1
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            cdk8s.io/metadata.addr: bookmarks-cron-bookmarks-cronjob-c8a60bb9
        spec:
          automountServiceAccountToken: false
          containers:
            - args:
                - curl
                - http://bookmarks:80/cron/$(CRON_TOKEN)
              env:
                - name: CRON_TOKEN
                  valueFrom:
                    secretKeyRef:
                      key: CRON_TOKEN
                      name: cron
              image: quay.io/curl/curl
              imagePullPolicy: Always
              name: main
              resources:
                limits:
                  memory: 32Mi
                requests:
                  memory: 32Mi
              securityContext:
                allowPrivilegeEscalation: false
                privileged: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
          dnsPolicy: ClusterFirst
          hostNetwork: false
          restartPolicy: Never
          securityContext:
            fsGroupChangePolicy: Always
            runAsGroup: 568
            runAsNonRoot: true
            runAsUser: 568
          setHostnameAsFQDN: false
          terminationGracePeriodSeconds: 30
  schedule: "*/15 * * * *"
  startingDeadlineSeconds: 10
  successfulJobsHistoryLimit: 1
  suspend: false
